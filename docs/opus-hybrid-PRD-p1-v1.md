Phase 1: Deep Analysis & Synthesis Planning
1.1 Systematic Element Mapping
Before creating the hybrid PRD, I will systematically map the best elements from each source document and my gap analysis.

Element Integration Matrix
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HYBRID PRD ELEMENT INTEGRATION MATRIX                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  SECTION                      â”‚ PRIMARY SOURCE â”‚ SUPPORTING â”‚ ENHANCEMENTS      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  Executive Summary            â”‚ Qwen           â”‚ Opus       â”‚ Add MVP focus     â”‚
â”‚  Business Case & ROI          â”‚ Qwen           â”‚ -          â”‚ Add NPV calc      â”‚
â”‚  Market Analysis              â”‚ Qwen           â”‚ Opus       â”‚ 2025 data update  â”‚
â”‚  User Personas                â”‚ Qwen           â”‚ -          â”‚ Add Lite Mode     â”‚
â”‚  Process Mapping              â”‚ Qwen           â”‚ -          â”‚ Add error flows   â”‚
â”‚  E-commerce Functional        â”‚ Nex-N1         â”‚ Qwen       â”‚ Add PWA details   â”‚
â”‚  Inventory Functional         â”‚ Qwen           â”‚ Opus       â”‚ Add lock mechanismâ”‚
â”‚  Accounting Functional        â”‚ Qwen           â”‚ Opus       â”‚ Add multi-currencyâ”‚
â”‚  Payment Integration          â”‚ Opus           â”‚ Qwen       â”‚ Add reconciliationâ”‚
â”‚  Logistics Integration        â”‚ Qwen           â”‚ Opus       â”‚ Add rate limiting â”‚
â”‚  Technical Architecture       â”‚ Opus           â”‚ Nex-N1     â”‚ MVP/Scale profilesâ”‚
â”‚  Database Schema              â”‚ Opus           â”‚ Qwen       â”‚ Add constraints   â”‚
â”‚  API Specifications           â”‚ Opus           â”‚ -          â”‚ Add versioning    â”‚
â”‚  Frontend Architecture        â”‚ Nex-N1         â”‚ -          â”‚ Add state mgmt    â”‚
â”‚  GST Compliance               â”‚ Qwen           â”‚ Opus       â”‚ Complete F5/F7    â”‚
â”‚  InvoiceNow/PEPPOL            â”‚ Qwen           â”‚ -          â”‚ Add error handlingâ”‚
â”‚  PDPA Framework               â”‚ Qwen           â”‚ Opus       â”‚ Add breach drill  â”‚
â”‚  Industry Licenses            â”‚ Qwen           â”‚ -          â”‚ Add automation    â”‚
â”‚  Security Implementation      â”‚ Opus           â”‚ -          â”‚ Add OWASP Top 10  â”‚
â”‚  Performance & Scalability    â”‚ Opus           â”‚ Nex-N1     â”‚ Add mobile metricsâ”‚
â”‚  Implementation Roadmap       â”‚ Opus           â”‚ Qwen       â”‚ Extend to 28 weeksâ”‚
â”‚  Risk Management              â”‚ Qwen           â”‚ Opus       â”‚ Add contingencies â”‚
â”‚  Success Metrics              â”‚ Qwen           â”‚ Opus       â”‚ Add dashboards    â”‚
â”‚  Budget Planning              â”‚ Opus           â”‚ Qwen       â”‚ Add PSG grant     â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Gap Integration Plan
Gap Identified	Solution Approach	Section Placement
Lite Mode Requirement	Create "Complexity Tier" system with feature toggles	Section 4 (Business Requirements)
Marketplace Inventory Sync	Redis-based distributed locking with atomic counters	Section 5 (Inventory Module)
Multi-Currency Handling	Currency conversion service with rate management	Section 5 (Accounting Module)
Offline POS Sync	Local storage with conflict resolution queue	Section 5 (E-commerce Module)
B2B Credit Terms	Credit management workflow with aging reports	Section 5 (Accounting Module)
Marketplace API Rate Limiting	Queue-based throttling with exponential backoff	Section 6 (Integration Architecture)
MVP vs Scale Infrastructure	Dual infrastructure profiles with migration path	Section 6 (Technical Architecture)
1.2 Document Architecture Plan
Part 1 Structure (This Response)
text

1. DOCUMENT CONTROL & OVERVIEW
2. EXECUTIVE SUMMARY & BUSINESS CASE
3. MARKET ANALYSIS & OPPORTUNITY
4. STAKEHOLDER ANALYSIS & USER PERSONAS
5. BUSINESS REQUIREMENTS
   5.1 Core Business Capabilities
   5.2 Complexity Tier System (NEW)
   5.3 Business Process Requirements
   5.4 Business Rules Engine
6. FUNCTIONAL REQUIREMENTS - PART A
   6.1 E-commerce Module (Complete)
   6.2 Inventory Management Module (Complete)
7. TECHNICAL ARCHITECTURE - PART A
   7.1 System Architecture Overview
   7.2 Technology Stack Decision
   7.3 Infrastructure Profiles (MVP vs Scale)
   7.4 Database Design (Complete Schema)
Part 2 Structure (Next Response)
text

8. FUNCTIONAL REQUIREMENTS - PART B
   8.1 Accounting Module (Complete)
   8.2 Payment Processing Module
   8.3 Logistics & Fulfillment Module
   8.4 Marketplace Integration Module
9. TECHNICAL ARCHITECTURE - PART B
   9.1 API Specifications
   9.2 Frontend Architecture
   9.3 Integration Architecture
10. COMPLIANCE & REGULATORY FRAMEWORK
11. SECURITY IMPLEMENTATION
12. PERFORMANCE & SCALABILITY
13. IMPLEMENTATION ROADMAP
14. QUALITY ASSURANCE & TESTING
15. BUDGET & RESOURCE PLANNING
16. RISK MANAGEMENT & MITIGATION
17. SUCCESS METRICS & KPIs
18. FUTURE ROADMAP & VISION
APPENDICES
1.3 Implementation Plan Validation
Pre-Execution Checklist
Content Completeness:

 All three PRD strengths mapped to sections
 All identified gaps addressed with solutions
 Singapore-specific requirements prioritized
 Hybrid architecture (Django backend + Next.js frontend) consistently applied
 MVP vs Scale considerations included throughout
 Business value quantification preserved from Qwen
Technical Accuracy:

 Database schemas use PostgreSQL 15+ syntax
 Python code uses Django 5.0+ patterns
 Frontend code uses Next.js 14+ with TypeScript
 Financial calculations use Decimal types
 GST calculations reflect 9% rate (2024+)
 API designs follow REST best practices
Stakeholder Accessibility:

 Executive summary accessible to non-technical readers
 Technical sections include rationale explanations
 Visual diagrams (Mermaid) used throughout
 Business impact quantified for each major feature
 Complexity tier system makes platform accessible to micro-SMBs
Quality Gates:

 Each section includes success criteria
 Validation checkpoints defined
 Measurable KPIs specified
 Risk considerations noted
1.4 Execution Authorization
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              IMPLEMENTATION PLAN VALIDATED                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Analysis Depth:        âœ… Complete                             â”‚
â”‚  Element Mapping:       âœ… All sources integrated               â”‚
â”‚  Gap Resolution:        âœ… All 7 gaps addressed                 â”‚
â”‚  Structure Validation:  âœ… Logical flow confirmed               â”‚
â”‚  Quality Gates:         âœ… Defined for each section             â”‚
â”‚                                                                 â”‚
â”‚  STATUS: READY FOR EXECUTION                                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
EXECUTION: HYBRID PRD - PART 1
ðŸ“‹ SINGAPORE SMB E-COMMERCE & INTEGRATED BUSINESS PLATFORM
COMPREHENSIVE PROJECT REQUIREMENTS DOCUMENT
Version 4.0 - Hybrid Architecture Edition
DOCUMENT CONTROL
Attribute	Details
Document Title	Singapore SMB E-Commerce & Integrated Business Platform PRD
Version	4.0 - Hybrid Architecture Edition
Date	January 2025
Status	Final - Ready for Implementation
Document Type	Master Project Requirements Document
Confidentiality	Proprietary and Confidential
Review Cycle	Quarterly Updates
Distribution	Authorized Stakeholders Only
Version History
Version	Date	Author	Changes
1.0	Dec 2024	Nex-N1 Team	Initial Node.js/Next.js specification
2.0	Dec 2024	Opus Team	Django comprehensive specification
3.0	Dec 2024	Qwen Team	Business-focused synthesis
4.0	Jan 2025	Hybrid Team	Ultimate synthesis: Django backend + Next.js frontend + comprehensive compliance
Document Governance
Role	Responsibility	Name
Document Owner	Final approval, scope changes	[Project Sponsor]
Technical Authority	Architecture decisions, technical accuracy	[Technical Lead]
Business Authority	Business requirements, ROI validation	[Business Owner]
Compliance Officer	Regulatory requirements, audit readiness	[Compliance Lead]
Change Control	Version management, distribution	[Project Manager]
TABLE OF CONTENTS - PART 1
Executive Summary & Business Case
Market Analysis & Opportunity
Stakeholder Analysis & User Personas
Business Requirements
Functional Requirements - E-commerce & Inventory
Technical Architecture - Foundation
1. EXECUTIVE SUMMARY & BUSINESS CASE
1.1 Project Vision
This document presents the definitive blueprint for Singapore's most comprehensive SMB e-commerce platform, synthesizing the best elements from multiple architectural approaches into a unified, compliance-ready system.

The Platform Integrates Three Critical Business Functions:

mermaid

graph TD
    A[Unified SMB Platform] --> B[E-Commerce Engine]
    A --> C[Inventory Management]
    A --> D[Integrated Accounting]
    
    B --> B1[Mobile-First Storefront]
    B --> B2[Multi-Channel Sales]
    B --> B3[Customer Experience]
    
    C --> C1[Real-Time Stock Tracking]
    C --> C2[Multi-Location Support]
    C --> C3[Automated Reordering]
    
    D --> D1[Automated Bookkeeping]
    D --> D2[GST Compliance]
    D --> D3[Financial Reporting]
    
    style A fill:#1a73e8,color:#fff
    style B fill:#34a853,color:#fff
    style C fill:#fbbc04,color:#000
    style D fill:#ea4335,color:#fff
Core Problem Statement:
Singapore SMBs face a critical fragmentation challenge â€” 85% currently use 5-7 different software tools, resulting in:

40% of operational time wasted on manual data entry and reconciliation
23% revenue loss from inventory discrepancies
S$15,000 average annual GST penalties from filing errors
68% checkout abandonment due to poor mobile experience
Our Solution:
A single, integrated platform that eliminates fragmentation while providing enterprise-grade compliance and consumer-grade user experience.

1.2 Hybrid Architecture Decision
After comprehensive analysis of multiple architectural approaches, we adopt a Hybrid Architecture that combines:

Component	Technology Choice	Rationale
Backend Framework	Django 5.0+ (Python)	Built-in admin, ORM integrity, decimal precision for financial math
API Layer	Django REST Framework	Production-proven, excellent documentation, OpenAPI support
Frontend Storefront	Next.js 14+ (React)	SSR/SSG for SEO, PWA capabilities, superior mobile performance
Admin Interface	Django Admin + Jazzmin	Zero development effort for internal tools, saves 10+ weeks
Database	PostgreSQL 15+	ACID compliance, JSONB support, financial-grade reliability
Cache/Queue	Redis 7+	Session management, real-time inventory locks, Celery broker
Task Processing	Celery 5.3+	Async order processing, scheduled GST reports, email queues
Architecture Justification:

Python

# Why Django for Backend (Not Node.js)
financial_precision_comparison = {
    'javascript': {
        'calculation': '0.1 + 0.2',
        'result': 0.30000000000004,  # IEEE 754 floating point error
        'risk': 'CRITICAL for financial systems'
    },
    'python_decimal': {
        'calculation': "Decimal('0.1') + Decimal('0.2')",
        'result': Decimal('0.3'),  # Exact precision
        'risk': 'None - native financial-grade precision'
    }
}

# Why Next.js for Frontend (Not Django Templates)
frontend_comparison = {
    'django_templates': {
        'mobile_performance': 'Server-rendered, slower interactivity',
        'seo': 'Good',
        'pwa_support': 'Manual implementation required',
        'developer_experience': 'Limited modern tooling'
    },
    'nextjs': {
        'mobile_performance': 'Hydration, instant interactivity',
        'seo': 'Excellent (SSR/SSG)',
        'pwa_support': 'Native with next-pwa',
        'developer_experience': 'Modern React ecosystem'
    }
}
1.3 Business Case & ROI Analysis
1.3.1 Market Opportunity
Singapore E-Commerce Market Trajectory:

Year	Market Size (USD)	YoY Growth	Mobile Share
2023	$4.1 billion	7.9%	65%
2024	$4.5 billion	9.8%	70%
2025	$5.0 billion	11.1%	73%
2026	$5.6 billion	12.0%	76%
2027	$6.3 billion	12.5%	78%
Target Market Size:

Total Singapore SMBs: 284,000
SMBs with e-commerce potential: 142,000 (50%)
Addressable market (10-200 employees): 45,000 (32%)
Serviceable market (Year 1-3): 5,000 (11%)
Initial target: 100-200 active clients
1.3.2 Quantified Business Impact
Per-Client Value Creation:

Metric	Current State	With Platform	Improvement	Annual Value
Order Processing Time	8.5 min/order	2.1 min/order	75% faster	S$24,000 labor savings
Inventory Accuracy	77%	99.5%	+22.5 points	S$50,000 revenue gain
GST Filing Errors	3.2/quarter	0	100% reduction	S$15,000 penalty avoided
Manual Data Entry	16 hrs/week	6.4 hrs/week	60% reduction	S$38,400 labor savings
Checkout Abandonment	68%	35%	-33 points	S$120,000 revenue lift
Month-End Close	5 days	0.5 days	90% faster	S$8,000 labor savings
Total Per-Client Annual Value				S$255,400
1.3.3 Investment Summary
Development Investment:

Phase	Duration	Investment	Deliverables
Phase 1: Foundation	Weeks 1-6	S$180,000	Core infrastructure, auth, admin
Phase 2: Compliance Core	Weeks 7-12	S$150,000	GST engine, PDPA, accounting
Phase 3: E-commerce Backend	Weeks 13-18	S$160,000	Orders, payments, inventory
Phase 4: Storefront	Weeks 19-24	S$140,000	Next.js PWA, mobile optimization
Phase 5: Integration & Launch	Weeks 25-28	S$120,000	Marketplace sync, testing, launch
Total Development	28 weeks	S$750,000	
Operational Costs (Monthly):

Component	MVP Profile	Scale Profile	Notes
AWS Infrastructure	S$800	S$3,500	ECS Fargate â†’ EKS transition
Database (RDS)	S$400	S$1,200	db.r6g.large â†’ db.r6g.2xlarge
Redis (ElastiCache)	S$150	S$500	cache.t3.medium â†’ cache.r6g.large
CDN (CloudFront)	S$100	S$400	Based on traffic
Third-party APIs	S$300	S$800	Payment gateways, logistics
Monitoring/Logging	S$150	S$600	CloudWatch â†’ Datadog
Monthly Total	S$1,900	S$7,000	
Annual Total	S$22,800	S$84,000	
ROI Projection:

Python

roi_analysis = {
    'initial_investment': 750000,  # Development
    'annual_operations': 50000,    # Average of MVP and Scale
    'annual_maintenance': 75000,   # 10% of development
    
    'revenue_model': {
        'monthly_subscription': {
            'starter': 299,    # Micro-SMB
            'professional': 599,  # Small SMB
            'enterprise': 1299    # Medium SMB
        },
        'transaction_fees': '0.5% of GMV',
        'implementation_fees': '1x monthly subscription'
    },
    
    'projections': {
        'year_1': {
            'clients': 60,
            'mrr': 35940,  # Mix of tiers
            'arr': 431280,
            'transaction_revenue': 50000,
            'total_revenue': 481280,
            'costs': 125000,
            'net': 356280
        },
        'year_2': {
            'clients': 150,
            'mrr': 89850,
            'arr': 1078200,
            'transaction_revenue': 150000,
            'total_revenue': 1228200,
            'costs': 200000,
            'net': 1028200
        },
        'year_3': {
            'clients': 300,
            'mrr': 179700,
            'arr': 2156400,
            'transaction_revenue': 350000,
            'total_revenue': 2506400,
            'costs': 350000,
            'net': 2156400
        }
    },
    
    'break_even': {
        'months': 14,
        'clients_required': 55
    },
    
    'npv_5_year': 4200000,  # At 10% discount rate
    'irr': 85  # Percentage
}
1.4 Strategic Objectives
Objective	Target Outcome	Success Metric	Timeline
Market Entry	Launch production platform	100 beta users	Month 7
Operational Excellence	60% process automation	Time per transaction	Month 9
Regulatory Compliance	100% GST/PDPA compliance	Zero violations	Ongoing
Inventory Optimization	99.5% stock accuracy	Cycle count variance	Month 10
Mobile Experience	<2s page load (4G)	PageSpeed score >90	Month 6
Financial Visibility	Real-time reporting	Dashboard refresh <5s	Month 8
Customer Acquisition	100 paying clients	MRR growth	Month 12
Revenue Target	S$500K ARR	Revenue tracking	Month 12
1.5 Key Differentiators
mermaid

graph LR
    A[Our Platform] --> B[Unified System]
    A --> C[Compliance-First]
    A --> D[Mobile-Optimized]
    A --> E[Scalable Pricing]
    A --> F[Singapore-Native]
    
    B --> B1[One platform for everything]
    C --> C1[Built-in GST, PDPA, InvoiceNow]
    D --> D1[<2s load, 70% mobile traffic]
    E --> E1[Starter to Enterprise tiers]
    F --> F1[PayNow, SingPass, local logistics]
2. MARKET ANALYSIS & OPPORTUNITY
2.1 Singapore E-Commerce Landscape
2.1.1 Market Dynamics
Digital Commerce Evolution:

Python

market_dynamics = {
    'internet_penetration': 98.5,  # % of population
    'smartphone_penetration': 95.2,  # % of population
    'e_commerce_participation': 82.0,  # % who have purchased online
    
    'payment_evolution': {
        'digital_wallets': 39.0,  # % of e-commerce transactions
        'credit_cards': 35.0,
        'debit_cards': 12.0,
        'bank_transfer': 8.0,
        'cash_on_delivery': 4.0,
        'bnpl': 2.0  # Growing 200%+ YoY
    },
    
    'paynow_adoption': {
        'gen_z_18_24': 72.0,  # %
        'millennials_25_34': 68.0,
        'gen_x_35_44': 55.0,
        'boomers_45_plus': 38.0,
        'business_adoption': 76.8
    },
    
    'mobile_commerce': {
        'traffic_share': 70.0,  # % of all e-commerce traffic
        'transaction_share': 62.0,  # % of all transactions
        'conversion_rate': 2.8,  # % (vs desktop 4.2%)
        'average_order_value': 85,  # SGD (vs desktop 120)
        'growth_rate': 25.0  # % YoY
    },
    
    'cross_border': {
        'shoppers_buying_overseas': 65.0,  # %
        'top_origins': ['China', 'USA', 'Japan', 'Korea', 'Malaysia'],
        'average_cross_border_aov': 150  # SGD
    }
}
2.1.2 Competitive Landscape
Platform Type	Market Share	Key Players	SMB Pain Points	Our Advantage
Marketplaces	60%	Shopee, Lazada, Amazon.sg	15-20% commission, no brand control, fragmented inventory	Unified inventory sync, brand ownership
SaaS Platforms	25%	Shopify, WooCommerce	Separate accounting, GST gaps, limited localization	Built-in Singapore compliance
Custom Solutions	15%	Bespoke development	S$200K+ cost, 12+ months, maintenance burden	70% cost reduction, 7-month delivery
Competitive Positioning Matrix:

mermaid

quadrantChart
    title Platform Positioning: Complexity vs Localization
    x-axis Low Complexity --> High Complexity
    y-axis Low Localization --> High Localization
    quadrant-1 Enterprise Solutions
    quadrant-2 Our Target Position
    quadrant-3 Global SaaS
    quadrant-4 Local Point Solutions
    
    Shopify: [0.3, 0.25]
    WooCommerce: [0.4, 0.2]
    SAP Business One: [0.85, 0.6]
    Xero: [0.25, 0.4]
    Our Platform: [0.55, 0.85]
    Custom Development: [0.9, 0.7]
2.2 Target Market Segmentation
2.2.1 Primary Segments
Python

market_segments = {
    'micro_smb': {
        'definition': {
            'revenue': 'S$100K - S$500K',
            'employees': '1-10',
            'sku_count': '50-200'
        },
        'characteristics': {
            'tech_readiness': 'Low-Medium',
            'current_tools': 'Excel, basic POS, manual accounting',
            'decision_maker': 'Owner (wears all hats)'
        },
        'pain_points': [
            'Manual inventory tracking in spreadsheets',
            'Quarterly GST filing stress',
            'No real-time business visibility',
            'Limited budget for technology'
        ],
        'platform_tier': 'Starter',
        'monthly_price': 299,
        'features_needed': 'Core e-commerce, basic inventory, GST calculation',
        'market_size': 25000,  # businesses
        'acquisition_strategy': 'Self-service, content marketing'
    },
    
    'small_smb': {
        'definition': {
            'revenue': 'S$500K - S$2M',
            'employees': '10-50',
            'sku_count': '200-1,000'
        },
        'characteristics': {
            'tech_readiness': 'Medium-High',
            'current_tools': 'Basic e-commerce + Xero/QuickBooks + separate inventory',
            'decision_maker': 'Owner + Operations Manager'
        },
        'pain_points': [
            'Multi-channel inventory sync nightmares',
            'Data entry duplication across systems',
            'Marketplace commission eating margins',
            'Growing GST complexity'
        ],
        'platform_tier': 'Professional',
        'monthly_price': 599,
        'features_needed': 'Multi-location inventory, marketplace sync, full accounting',
        'market_size': 15000,
        'acquisition_strategy': 'Sales-assisted, demos'
    },
    
    'medium_smb': {
        'definition': {
            'revenue': 'S$2M - S$10M',
            'employees': '50-200',
            'sku_count': '1,000-5,000'
        },
        'characteristics': {
            'tech_readiness': 'High',
            'current_tools': 'Fragmented best-of-breed stack',
            'decision_maker': 'CFO/COO with IT input'
        },
        'pain_points': [
            'Integration maintenance burden',
            'Compliance audit preparation',
            'Real-time inventory across locations',
            'B2B customer management'
        ],
        'platform_tier': 'Enterprise',
        'monthly_price': 1299,
        'features_needed': 'All features + API access + priority support',
        'market_size': 5000,
        'acquisition_strategy': 'Enterprise sales, case studies'
    }
}
2.2.2 Industry Verticals
Vertical	Market Share	Key Requirements	Regulatory Bodies
Retail (Fashion, Electronics, Home)	35%	Multi-variant products, seasonal inventory, loyalty programs	ACRA, IRAS
Food & Beverage	25%	Ingredient tracking, batch management, expiry dates	SFA, NEA, MUIS
Health & Beauty	20%	Product registration, batch recall, HSA compliance	HSA, IRAS
B2B Wholesale	20%	Tiered pricing, credit terms, bulk ordering	ACRA, IRAS
2.3 Government Support & Incentives
2.3.1 Productivity Solutions Grant (PSG)
Python

psg_eligibility = {
    'requirements': {
        'registration': 'Registered and operating in Singapore',
        'ownership': '>= 30% local shareholding',
        'employees': 'OR >= 3 local employees',
        'revenue': 'Group annual sales turnover <= S$100M',
        'headcount': 'Group employment size <= 200'
    },
    
    'support_level': {
        '2024_onwards': 50,  # % of qualifying costs
        'maximum_claim': 30000  # SGD per solution
    },
    
    'our_platform_listing': {
        'status': 'Pre-approved solution (target)',
        'category': 'E-commerce and Inventory Management',
        'qualifying_costs': [
            'Software subscription (12 months)',
            'Implementation and training',
            'Data migration services'
        ]
    },
    
    'client_value': {
        'platform_cost': 599 * 12,  # S$7,188 annual
        'implementation': 2000,
        'total_qualifying': 9188,
        'psg_claim': 4594,  # 50%
        'net_cost': 4594,
        'effective_monthly': 383  # vs S$599
    }
}
3. STAKEHOLDER ANALYSIS & USER PERSONAS
3.1 Stakeholder Ecosystem
mermaid

graph TD
    subgraph Internal["Internal Stakeholders"]
        A1[Business Owner]
        A2[Operations Manager]
        A3[Accountant/Bookkeeper]
        A4[Warehouse Staff]
        A5[Sales Staff]
        A6[Customer Service]
    end
    
    subgraph External["External Stakeholders"]
        B1[End Customers]
        B2[Suppliers]
        B3[Marketplace Platforms]
    end
    
    subgraph Partners["Integration Partners"]
        C1[Payment Gateways]
        C2[Logistics Providers]
        C3[Accounting Software]
    end
    
    subgraph Regulators["Regulatory Bodies"]
        D1[IRAS - Tax Authority]
        D2[PDPC - Data Protection]
        D3[ACRA - Business Registry]
        D4[Industry Regulators]
    end
    
    A1 --> Platform[Our Platform]
    A2 --> Platform
    A3 --> Platform
    A4 --> Platform
    A5 --> Platform
    A6 --> Platform
    
    Platform --> B1
    Platform --> B2
    Platform --> B3
    
    Platform <--> C1
    Platform <--> C2
    Platform <--> C3
    
    Platform --> D1
    Platform --> D2
    Platform --> D3
    Platform --> D4
3.2 Detailed User Personas
3.2.1 Primary Persona: Sarah Chen â€” SMB Owner
Python

persona_sarah = {
    'identity': {
        'name': 'Sarah Chen',
        'age': 38,
        'role': 'Founder & Managing Director',
        'business': 'Fashion Retail (2 stores + online)',
        'location': 'Singapore (lives in Tampines, stores in Orchard & VivoCity)'
    },
    
    'business_profile': {
        'company_name': 'Urban Style Pte Ltd',
        'years_in_business': 6,
        'annual_revenue': 'S$1.8 million',
        'employees': 12,
        'sku_count': 450,
        'channels': ['2 retail stores', 'Own website', 'Shopee', 'Lazada'],
        'growth_target': 'S$3M revenue in 2 years'
    },
    
    'tech_profile': {
        'savviness': 'Intermediate',
        'current_tools': {
            'e_commerce': 'Shopify Basic',
            'accounting': 'Xero',
            'inventory': 'Excel spreadsheets',
            'pos': 'Separate POS per store',
            'marketplaces': 'Direct seller accounts'
        },
        'monthly_software_spend': 450,  # SGD
        'devices': ['iPhone Pro', 'MacBook', 'iPad at stores']
    },
    
    'daily_challenges': [
        {
            'challenge': 'Inventory reconciliation across 4 channels',
            'current_solution': 'Manual count every Sunday (4 hours)',
            'pain_level': 'Critical',
            'quote': '"I sold the same dress to 3 people last month because Shopee and my website weren\'t synced."'
        },
        {
            'challenge': 'GST quarterly filing',
            'current_solution': 'Accountant takes 3 days to compile data from 4 systems',
            'pain_level': 'High',
            'quote': '"We got a S$2,000 penalty last year for a calculation error."'
        },
        {
            'challenge': 'Real-time business visibility',
            'current_solution': 'Wait for month-end reports from accountant',
            'pain_level': 'Medium',
            'quote': '"I don\'t know if we\'re profitable until 3 weeks after the month ends."'
        },
        {
            'challenge': 'Staff training on multiple systems',
            'current_solution': 'New staff take 2 weeks to learn all tools',
            'pain_level': 'Medium',
            'quote': '"Every new hire means 2 weeks of my time training them on 5 different systems."'
        }
    ],
    
    'goals': {
        'immediate': [
            'Stop overselling on marketplaces',
            'Reduce GST filing time to 1 day',
            'See real-time sales on mobile'
        ],
        'short_term': [
            'Open 3rd store in 2025',
            'Launch B2B wholesale channel',
            'Reduce operational headcount by 1 FTE'
        ],
        'long_term': [
            'Franchise the business',
            'Expand to Malaysia',
            'Achieve S$5M revenue'
        ]
    },
    
    'success_metrics': {
        'time_saved': '10+ hours/week on admin tasks',
        'inventory_accuracy': '99%+ stock accuracy',
        'gst_compliance': 'Zero filing errors',
        'visibility': 'Real-time P&L on mobile',
        'staff_efficiency': '50% reduction in training time'
    },
    
    'platform_tier': 'Professional',
    'decision_criteria': [
        'Integration with existing Xero (can\'t retrain accountant)',
        'Mobile app for checking business on-the-go',
        'Shopee/Lazada sync that actually works',
        'Under S$800/month total'
    ]
}
3.2.2 Operations Manager: Marcus Tan
Python

persona_marcus = {
    'identity': {
        'name': 'Marcus Tan',
        'age': 32,
        'role': 'Operations Manager',
        'reports_to': 'Sarah Chen (Owner)',
        'direct_reports': 4  # 2 warehouse staff, 2 store staff
    },
    
    'responsibilities': [
        'Inventory management across 2 stores + warehouse',
        'Supplier relationship and purchasing',
        'Order fulfillment and logistics coordination',
        'Staff scheduling and performance tracking',
        'Stock takes and cycle counting'
    ],
    
    'daily_workflow': {
        '8:00_am': 'Check overnight online orders, allocate to warehouse',
        '9:00_am': 'Review low stock alerts, create purchase orders',
        '10:00_am': 'Coordinate with courier for pickups',
        '12:00_pm': 'Handle store replenishment requests',
        '2:00_pm': 'Supplier calls, delivery scheduling',
        '4:00_pm': 'Process marketplace order downloads',
        '5:00_pm': 'Reconcile daily shipments, update tracking',
        '6:00_pm': 'Prepare next day pick lists'
    },
    
    'pain_points': [
        {
            'issue': 'Manual stock counting takes 4 hours every week',
            'impact': 'Lost productivity, still inaccurate',
            'desired_solution': 'Barcode scanning with mobile app'
        },
        {
            'issue': 'Marketplace order download is manual CSV export',
            'impact': '30 minutes daily, errors in copy-paste',
            'desired_solution': 'Real-time order sync via API'
        },
        {
            'issue': 'No automated reorder suggestions',
            'impact': 'Frequent stockouts of bestsellers, overstock of slow movers',
            'desired_solution': 'AI-powered reorder recommendations'
        },
        {
            'issue': 'Stock transfers between locations tracked in WhatsApp',
            'impact': 'Lost items, no audit trail',
            'desired_solution': 'Formal transfer workflow with scanning'
        }
    ],
    
    'tech_comfort': {
        'level': 'High',
        'preferred_devices': ['Android phone', 'Windows laptop', 'Handheld scanner'],
        'apps_used_daily': ['WhatsApp', 'Google Sheets', 'Shopee Seller Centre', 'Lazada Seller Centre']
    },
    
    'success_metrics': {
        'inventory_accuracy': '> 99% match between system and physical',
        'stockout_rate': '< 1% of SKUs',
        'fulfillment_time': '< 30 minutes from order to pack',
        'inventory_turnover': '20% improvement',
        'reorder_efficiency': 'Auto-suggestions for 80% of POs'
    },
    
    'platform_requirements': [
        'Mobile barcode scanning app (Android)',
        'Real-time inventory across all locations',
        'Automated low-stock alerts to phone',
        'Transfer orders with approval workflow',
        'Integration with existing courier accounts'
    ]
}
3.2.3 Accountant: Priya Kumar
Python

persona_priya = {
    'identity': {
        'name': 'Priya Kumar',
        'age': 45,
        'role': 'Part-time Accountant (3 days/week)',
        'qualification': 'ACCA certified',
        'clients': 5  # Urban Style is one of 5 SMB clients
    },
    
    'responsibilities': [
        'Monthly financial closing and reporting',
        'Quarterly GST F5 filing',
        'Annual financial statements for ACRA',
        'Bank reconciliation',
        'Accounts payable and receivable management',
        'Payroll processing (CPF submissions)'
    ],
    
    'pain_points': [
        {
            'issue': 'Data from 4 different systems needs manual consolidation',
            'time_spent': '8 hours per month-end close',
            'impact': 'Reports delayed, errors common',
            'quote': '"I spend more time copying data than analyzing it."'
        },
        {
            'issue': 'GST calculation across multiple sales channels',
            'time_spent': '3 days per quarter',
            'impact': 'Filing deadline stress, penalty risk',
            'quote': '"Matching Shopee settlements to invoices is a nightmare."'
        },
        {
            'issue': 'No real-time visibility into cash position',
            'impact': 'Sarah calls me asking about cash flow, I don\'t know',
            'quote': '"I can only tell her what happened last month."'
        },
        {
            'issue': 'Audit trail gaps when staff make inventory adjustments',
            'impact': 'Stock discrepancies unexplainable',
            'quote': '"Someone adjusted 50 units but nobody documented why."'
        }
    ],
    
    'current_tools': {
        'primary': 'Xero (Singapore edition)',
        'spreadsheets': 'Excel for reconciliations and analysis',
        'filing': 'IRAS myTax Portal (manual)',
        'document_storage': 'Google Drive'
    },
    
    'requirements': {
        'must_have': [
            'Integration with Xero (will not switch accounting software)',
            'Automated journal entries from sales',
            'GST F5 report generation',
            'Audit trail for all transactions',
            'Bank feed reconciliation'
        ],
        'nice_to_have': [
            'Direct IRAS filing (stretch goal)',
            'Aged receivables automation',
            'Budget vs actual reporting',
            'Cash flow forecasting'
        ],
        'deal_breakers': [
            'If I have to learn a completely new accounting system',
            'If data export isn\'t in standard formats (CSV, PDF)',
            'If there\'s no proper audit trail'
        ]
    },
    
    'success_metrics': {
        'month_end_close': '< 1 day (from 5 days)',
        'gst_filing': '< 2 hours (from 3 days)',
        'data_entry': '85% reduction in manual entry',
        'audit_prep': '90% reduction in document gathering',
        'accuracy': 'Zero GST penalties'
    }
}
3.2.4 End Customer: Digital Native Shopper
Python

persona_customer = {
    'identity': {
        'name': 'Amanda Lim',
        'age': 28,
        'occupation': 'Marketing Executive',
        'location': 'Singapore (Punggol)',
        'income': 'S$5,000-6,000/month'
    },
    
    'shopping_behavior': {
        'devices': {
            'mobile': 85,  # % of browsing
            'desktop': 10,
            'tablet': 5
        },
        'preferred_payment': ['PayNow', 'GrabPay', 'Credit Card'],
        'monthly_online_spend': 400,  # SGD
        'categories': ['Fashion', 'Beauty', 'Home', 'Electronics'],
        'channels': ['Instagram discovery', 'Google search', 'Shopee comparison']
    },
    
    'purchase_journey': {
        'discovery': 'Instagram ads, influencer recommendations',
        'research': 'Check reviews, compare prices on Shopee/Lazada',
        'evaluation': 'Visit brand website for authenticity, full range',
        'purchase': 'Price-match if available, prefer brand website for returns',
        'fulfillment': 'Expect next-day or same-day delivery options',
        'post_purchase': 'Track via WhatsApp updates, easy returns'
    },
    
    'expectations': {
        'page_load': '< 3 seconds or abandon',
        'checkout_steps': '<= 3 steps',
        'payment_options': 'Must have PayNow',
        'delivery_info': 'Real-time tracking updates',
        'returns': 'Free returns within 7 days'
    },
    
    'frustrations': [
        'Slow mobile sites that aren\'t optimized',
        'Having to create an account before seeing prices',
        'No PayNow option',
        'Vague delivery estimates ("3-7 business days")',
        'Hard to reach customer service'
    ],
    
    'platform_impact': {
        'target_nps': 70,
        'target_csat': 4.5,  # out of 5
        'repeat_purchase_rate': 35,  # % within 90 days
        'referral_rate': 15  # % who refer friends
    }
}
3.3 User Journey Maps
3.3.1 Customer Purchase Journey
mermaid

journey
    title Customer Purchase Journey
    section Discovery
        See Instagram ad: 5: Amanda
        Click through to website: 4: Amanda
        Mobile site loads in 1.8s: 5: Amanda
    section Browse
        Browse product categories: 4: Amanda
        Use search with filters: 5: Amanda
        View product details: 4: Amanda
        Check reviews: 5: Amanda
    section Consider
        Add to cart: 5: Amanda
        View similar products: 4: Amanda
        Check delivery options: 5: Amanda
    section Purchase
        Guest checkout (email only): 5: Amanda
        Select PayNow: 5: Amanda
        Scan QR code: 5: Amanda
        Receive instant confirmation: 5: Amanda
    section Fulfill
        Get WhatsApp tracking: 5: Amanda
        Real-time delivery updates: 5: Amanda
        Receive package next day: 5: Amanda
    section Post-Purchase
        Easy returns if needed: 4: Amanda
        Leave review: 4: Amanda
        Receive personalized offers: 4: Amanda
3.3.2 Admin Order Processing Journey
mermaid

sequenceDiagram
    participant C as Customer
    participant S as Storefront
    participant O as Order System
    participant I as Inventory
    participant P as Payment
    participant W as Warehouse
    participant L as Logistics
    participant A as Accounting

    C->>S: Place Order
    S->>I: Check Stock Availability
    I-->>S: Stock Confirmed (Reserved)
    S->>P: Process Payment
    P-->>S: Payment Confirmed
    S->>O: Create Order Record
    O->>W: Generate Pick List
    O->>A: Create Journal Entry (Auto)
    W->>W: Pick & Pack
    W->>L: Generate Shipping Label
    L->>C: Dispatch & Track
    L-->>O: Delivery Confirmed
    O->>I: Release Reservation â†’ Sold
    O->>A: Recognize Revenue (Auto)
4. BUSINESS REQUIREMENTS
4.1 Core Business Capabilities
4.1.1 Capability Matrix
Capability	Description	Business Value	Priority
Omnichannel Sales	Sell via web, mobile, POS, marketplaces	30% revenue increase	P0
Centralized Inventory	Single source of truth across locations	60% reduction in stockouts	P0
Integrated Accounting	Automated financial recording	40% time savings	P0
GST Compliance	Automated calculation and filing	Zero penalties	P0
Customer Management	360Â° customer view	25% retention improvement	P1
Analytics & Insights	Real-time business intelligence	Data-driven decisions	P1
Marketplace Sync	Bi-directional inventory/order sync	Eliminate overselling	P0
Mobile Operations	Full functionality on mobile	Operational flexibility	P1
4.2 Complexity Tier System (NEW)
Critical Addition: To address the "Lite Mode" gap, we introduce a Complexity Tier System that makes the platform accessible to micro-SMBs while supporting enterprise needs.

Python

complexity_tiers = {
    'starter': {
        'name': 'Starter',
        'target': 'Micro-SMB (1-10 employees)',
        'monthly_price': 299,
        
        'features_enabled': {
            # E-commerce
            'product_catalog': True,
            'product_variants': True,  # Max 3 variants per product
            'shopping_cart': True,
            'guest_checkout': True,
            'member_accounts': True,
            
            # Inventory
            'single_location': True,
            'multi_location': False,  # Upgrade required
            'stock_tracking': True,
            'low_stock_alerts': True,
            'barcode_scanning': False,  # Upgrade required
            'batch_lot_tracking': False,
            
            # Accounting
            'basic_invoicing': True,
            'gst_calculation': True,
            'gst_f5_report': True,
            'double_entry_accounting': False,  # Hidden, uses simplified view
            'bank_reconciliation': False,
            'xero_integration': False,
            
            # Payments
            'stripe': True,
            'paynow': True,
            'grabpay': True,
            'bnpl': False,
            
            # Operations
            'basic_reporting': True,
            'advanced_analytics': False,
            'api_access': False,
            'marketplace_sync': False  # Manual export only
        },
        
        'limits': {
            'products': 200,
            'orders_per_month': 500,
            'storage_gb': 5,
            'team_members': 3
        },
        
        'hidden_complexity': [
            'Double-entry journal entries (auto-generated, not shown)',
            'Advanced inventory costing (uses simple average cost)',
            'Complex GST scenarios (defaults to standard-rated)'
        ]
    },
    
    'professional': {
        'name': 'Professional',
        'target': 'Small SMB (10-50 employees)',
        'monthly_price': 599,
        
        'features_enabled': {
            # All Starter features plus:
            'multi_location': True,  # Up to 5 locations
            'barcode_scanning': True,
            'batch_lot_tracking': True,
            'fifo_lifo_costing': True,
            
            'double_entry_accounting': True,  # Full visibility
            'bank_reconciliation': True,
            'xero_integration': True,
            'quickbooks_integration': True,
            
            'bnpl': True,
            'marketplace_sync': True,  # Shopee, Lazada
            'advanced_analytics': True,
            'b2b_pricing': True,
            'customer_credit': True
        },
        
        'limits': {
            'products': 2000,
            'orders_per_month': 5000,
            'storage_gb': 50,
            'team_members': 15,
            'locations': 5
        }
    },
    
    'enterprise': {
        'name': 'Enterprise',
        'target': 'Medium SMB (50-200 employees)',
        'monthly_price': 1299,
        
        'features_enabled': {
            # All Professional features plus:
            'unlimited_locations': True,
            'warehouse_management': True,
            'purchase_order_workflow': True,
            'approval_workflows': True,
            
            'invoicenow_peppol': True,
            'multi_currency': True,
            'inter_company': True,
            
            'api_access': True,
            'custom_integrations': True,
            'dedicated_support': True,
            'sla_guarantee': True
        },
        
        'limits': {
            'products': 'Unlimited',
            'orders_per_month': 'Unlimited',
            'storage_gb': 500,
            'team_members': 50,
            'locations': 'Unlimited'
        }
    }
}

# Feature Toggle Implementation
class FeatureToggle:
    """Control feature visibility based on subscription tier"""
    
    def __init__(self, company):
        self.company = company
        self.tier = company.subscription_tier
        self.tier_config = complexity_tiers[self.tier]
    
    def is_enabled(self, feature_name):
        """Check if a feature is enabled for this company's tier"""
        return self.tier_config['features_enabled'].get(feature_name, False)
    
    def get_limit(self, limit_name):
        """Get the limit value for a specific resource"""
        limit = self.tier_config['limits'].get(limit_name)
        if limit == 'Unlimited':
            return float('inf')
        return limit
    
    def check_limit(self, limit_name, current_usage):
        """Check if current usage is within tier limits"""
        limit = self.get_limit(limit_name)
        return current_usage < limit
    
    def get_upgrade_prompt(self, feature_name):
        """Get upgrade prompt for locked features"""
        if self.is_enabled(feature_name):
            return None
        
        upgrade_prompts = {
            'multi_location': {
                'message': 'Multi-location inventory requires Professional tier',
                'upgrade_to': 'professional',
                'benefit': 'Manage inventory across up to 5 locations'
            },
            'marketplace_sync': {
                'message': 'Automatic Shopee/Lazada sync requires Professional tier',
                'upgrade_to': 'professional',
                'benefit': 'Real-time inventory sync, no more overselling'
            },
            'api_access': {
                'message': 'API access requires Enterprise tier',
                'upgrade_to': 'enterprise',
                'benefit': 'Build custom integrations with your other systems'
            }
        }
        
        return upgrade_prompts.get(feature_name, {
            'message': f'{feature_name} requires an upgraded subscription',
            'upgrade_to': 'professional'
        })
4.3 Business Process Requirements
4.3.1 Order-to-Cash (O2C) Process
mermaid

graph LR
    subgraph Customer
        A[Browse] --> B[Add to Cart]
        B --> C[Checkout]
        C --> D[Pay]
    end
    
    subgraph Platform
        D --> E[Order Created]
        E --> F[Inventory Reserved]
        F --> G[Payment Verified]
        G --> H[Pick List Generated]
        H --> I[Picked & Packed]
        I --> J[Shipped]
        J --> K[Delivered]
    end
    
    subgraph Accounting
        G --> L[AR Entry Created]
        K --> M[Revenue Recognized]
        M --> N[GST Recorded]
    end
    
    style A fill:#e3f2fd
    style D fill:#c8e6c9
    style K fill:#c8e6c9
    style N fill:#fff3e0
O2C Process Specifications:

Python

o2c_process = {
    'stages': [
        {
            'stage': 'Order Placement',
            'trigger': 'Customer completes checkout',
            'system_actions': [
                'Validate cart items and prices',
                'Check inventory availability (real-time)',
                'Reserve inventory (soft lock)',
                'Create order record with unique number',
                'Send order confirmation email'
            ],
            'success_criteria': 'Order created with reserved inventory',
            'sla': '< 3 seconds',
            'error_handling': {
                'insufficient_stock': 'Show alternative products, allow backorder if enabled',
                'payment_declined': 'Release inventory reservation, show retry options',
                'system_error': 'Queue order for retry, notify customer'
            }
        },
        {
            'stage': 'Payment Processing',
            'trigger': 'Order created',
            'system_actions': [
                'Route to appropriate payment gateway',
                'Process payment authorization',
                'Handle 3D Secure if required',
                'Record payment transaction',
                'Update order status to "Paid"'
            ],
            'success_criteria': 'Payment confirmed and recorded',
            'sla': '< 10 seconds (gateway-dependent)',
            'supported_methods': {
                'instant': ['PayNow', 'GrabPay', 'Credit Card', 'Apple Pay'],
                'deferred': ['Bank Transfer', 'BNPL'],
                'cod': ['Cash on Delivery']
            }
        },
        {
            'stage': 'Fulfillment Initiation',
            'trigger': 'Payment confirmed',
            'system_actions': [
                'Convert reservation to allocation',
                'Determine optimal fulfillment location',
                'Generate pick list (optimized route)',
                'Assign to warehouse staff',
                'Send notification to warehouse app'
            ],
            'success_criteria': 'Pick list assigned to staff',
            'sla': '< 1 minute',
            'allocation_logic': {
                'priority': ['Nearest to customer', 'Highest stock', 'Lowest cost'],
                'split_order': 'Only if single location cannot fulfill'
            }
        },
        {
            'stage': 'Pick and Pack',
            'trigger': 'Pick list assigned',
            'system_actions': [
                'Staff scans items during picking',
                'Validate item against order',
                'Record any discrepancies',
                'Generate packing slip',
                'Weigh package for shipping cost'
            ],
            'success_criteria': 'All items picked and verified',
            'sla': '< 30 minutes',
            'error_handling': {
                'item_not_found': 'Flag for inventory adjustment, offer alternative',
                'damaged_item': 'Flag for write-off, pick replacement'
            }
        },
        {
            'stage': 'Shipping',
            'trigger': 'Packing complete',
            'system_actions': [
                'Select optimal carrier based on rules',
                'Generate shipping label via carrier API',
                'Schedule pickup or arrange drop-off',
                'Send tracking number to customer',
                'Update order status to "Shipped"'
            ],
            'success_criteria': 'Tracking number generated and sent',
            'sla': '< 5 minutes',
            'carrier_selection': {
                'rules': ['Cheapest within SLA', 'Customer preference', 'Same-day if requested'],
                'fallback': 'Next available carrier if preferred unavailable'
            }
        },
        {
            'stage': 'Delivery',
            'trigger': 'Package in transit',
            'system_actions': [
                'Poll carrier API for status updates',
                'Send proactive notifications to customer',
                'Handle delivery exceptions',
                'Confirm delivery with POD',
                'Update order status to "Delivered"'
            ],
            'success_criteria': 'Delivery confirmed',
            'sla': 'Per carrier SLA (1-3 days standard)',
            'notifications': {
                'channels': ['Email', 'SMS', 'WhatsApp'],
                'events': ['Out for delivery', 'Delivered', 'Delivery attempted']
            }
        },
        {
            'stage': 'Revenue Recognition',
            'trigger': 'Delivery confirmed',
            'system_actions': [
                'Post revenue journal entry',
                'Record GST output tax',
                'Update inventory (reserved â†’ sold)',
                'Close order',
                'Update customer purchase history'
            ],
            'success_criteria': 'Revenue and inventory properly recorded',
            'sla': '< 1 minute (automated)',
            'accounting_entries': {
                'revenue': 'Credit Sales Revenue (4000)',
                'gst': 'Credit GST Payable (2100)',
                'cash': 'Debit Cash/AR (1000/1100)'
            }
        }
    ],
    
    'success_metrics': {
        'order_to_ship': '< 4 hours (business hours)',
        'order_to_deliver': '< 2 days (standard)',
        'order_accuracy': '> 99.5%',
        'on_time_delivery': '> 95%',
        'automation_rate': '> 90%'
    }
}
4.3.2 Procure-to-Pay (P2P) Process
mermaid

graph LR
    subgraph Planning
        A[Reorder Alert] --> B[Review Recommendations]
        B --> C[Create PO]
    end
    
    subgraph Ordering
        C --> D[Send to Supplier]
        D --> E[Supplier Confirms]
    end
    
    subgraph Receiving
        E --> F[Goods Arrive]
        F --> G[Receive & Inspect]
        G --> H[Stock Updated]
    end
    
    subgraph Payment
        H --> I[Invoice Received]
        I --> J[3-Way Match]
        J --> K[Schedule Payment]
        K --> L[Payment Made]
    end
    
    subgraph Accounting
        H --> M[Inventory Increased]
        L --> N[AP Decreased]
        N --> O[Cash Decreased]
    end
    
    style A fill:#ffcdd2
    style H fill:#c8e6c9
    style L fill:#c8e6c9
P2P Process Specifications:

Python

p2p_process = {
    'stages': [
        {
            'stage': 'Reorder Planning',
            'trigger': 'Stock falls below reorder point OR scheduled review',
            'system_actions': [
                'Calculate reorder quantity based on algorithm',
                'Apply safety stock buffer',
                'Consider lead time and in-transit stock',
                'Factor in pending POs and reserved stock',
                'Generate reorder recommendation'
            ],
            'algorithm': '''
                reorder_qty = max(
                    (lead_time_days * avg_daily_sales) + safety_stock - available_stock - in_transit,
                    economic_order_quantity
                )
            ''',
            'approval_required': 'If total PO value > S$5,000',
            'tier_behavior': {
                'starter': 'Manual reorder only, no automated suggestions',
                'professional': 'Automated suggestions, manual approval',
                'enterprise': 'Automated suggestions with approval workflow'
            }
        },
        {
            'stage': 'Purchase Order Creation',
            'trigger': 'User approves recommendation OR creates manually',
            'system_actions': [
                'Create PO header with supplier details',
                'Add line items with quantities and prices',
                'Apply negotiated pricing from supplier contract',
                'Calculate expected delivery date',
                'Generate PO number'
            ],
            'validation': [
                'Supplier is active',
                'Products are associated with supplier',
                'Quantity within min/max order limits',
                'Total within approval limits'
            ],
            'outputs': ['PO document (PDF)', 'PO record in system']
        },
        {
            'stage': 'Supplier Communication',
            'trigger': 'PO approved and ready to send',
            'system_actions': [
                'Send PO to supplier via email',
                'Track acknowledgment status',
                'Handle supplier amendments',
                'Escalate if no response in 48 hours'
            ],
            'integration': {
                'email': 'Automated email with PDF attachment',
                'api': 'Direct API integration with major suppliers (future)',
                'peppol': 'InvoiceNow purchase order transmission (Enterprise tier)'
            }
        },
        {
            'stage': 'Goods Receipt',
            'trigger': 'Shipment arrives at warehouse',
            'system_actions': [
                'Scan items against PO',
                'Record received quantities',
                'Flag discrepancies (over/under shipment)',
                'Quality inspection if configured',
                'Update inventory levels',
                'Generate Goods Receipt Note (GRN)'
            ],
            'discrepancy_handling': {
                'under_shipment': 'Keep PO open for balance, notify purchasing',
                'over_shipment': 'Accept or reject overage, notify purchasing',
                'damaged_goods': 'Quarantine, initiate return/credit process',
                'wrong_items': 'Quarantine, initiate return/replacement process'
            },
            'inventory_impact': 'Increase on-hand quantity at receiving location'
        },
        {
            'stage': 'Invoice Matching',
            'trigger': 'Supplier invoice received',
            'system_actions': [
                'Capture invoice details (manual or OCR)',
                'Perform 3-way match: PO â†” GRN â†” Invoice',
                'Flag variances beyond tolerance',
                'Route exceptions for approval',
                'Create AP entry if matched'
            ],
            'tolerance': {
                'quantity': '2% variance auto-approved',
                'price': '1% variance auto-approved',
                'total': 'S$50 variance auto-approved'
            },
            'accounting_entry': {
                'debit': 'Inventory (1300) OR Expense per PO',
                'credit': 'Accounts Payable (2000)'
            }
        },
        {
            'stage': 'Payment Processing',
            'trigger': 'Invoice approved and due date approaching',
            'system_actions': [
                'Group invoices for payment run',
                'Apply early payment discounts if beneficial',
                'Generate payment file for bank',
                'Execute payment via bank API',
                'Record payment transaction',
                'Update AP ledger'
            ],
            'payment_timing': {
                'strategy': 'Pay on due date unless discount justifies early payment',
                'discount_threshold': 'Pay early if discount APR > cost of capital'
            },
            'accounting_entry': {
                'debit': 'Accounts Payable (2000)',
                'credit': 'Cash (1000)'
            }
        }
    ],
    
    'success_metrics': {
        'po_to_receipt': '< 7 days (depends on supplier)',
        'invoice_matching_rate': '> 85% auto-matched',
        'payment_accuracy': '100% (no duplicate payments)',
        'early_payment_capture': '> 80% of available discounts',
        'ap_aging': '< 30 days average'
    }
}
4.4 Business Rules Engine
4.4.1 Pricing Rules
Python

class PricingEngine:
    """Comprehensive pricing rules engine"""
    
    def __init__(self, company):
        self.company = company
        self.rules = self.load_pricing_rules()
    
    def calculate_price(self, product, customer, quantity, context=None):
        """Calculate final price applying all applicable rules"""
        
        base_price = product.base_price
        
        # Step 1: Apply customer tier pricing
        tier_price = self.apply_customer_tier(base_price, customer)
        
        # Step 2: Apply quantity-based discounts
        quantity_price = self.apply_quantity_discount(tier_price, product, quantity)
        
        # Step 3: Apply active promotions
        promo_price = self.apply_promotions(quantity_price, product, customer, context)
        
        # Step 4: Apply minimum price floor
        final_price = max(promo_price, product.minimum_price or 0)
        
        # Step 5: Calculate GST
        gst_amount = self.calculate_gst(final_price, product.gst_type)
        
        return {
            'base_price': base_price,
            'final_price': final_price,
            'gst_amount': gst_amount,
            'total_price': final_price + (gst_amount or Decimal('0')),
            'discounts_applied': self.get_applied_discounts()
        }
    
    def apply_customer_tier(self, price, customer):
        """Apply pricing based on customer tier"""
        tier_multipliers = {
            'retail': Decimal('1.00'),
            'wholesale': Decimal('0.70'),
            'vip': Decimal('0.80'),
            'distributor': Decimal('0.60')
        }
        
        multiplier = tier_multipliers.get(customer.tier, Decimal('1.00'))
        return price * multiplier
    
    def apply_quantity_discount(self, price, product, quantity):
        """Apply quantity-based discounts"""
        quantity_breaks = product.quantity_discounts or []
        
        # Example: [{'min_qty': 10, 'discount_pct': 5}, {'min_qty': 50, 'discount_pct': 10}]
        applicable_discount = Decimal('0')
        
        for break_point in sorted(quantity_breaks, key=lambda x: x['min_qty'], reverse=True):
            if quantity >= break_point['min_qty']:
                applicable_discount = Decimal(str(break_point['discount_pct'])) / 100
                break
        
        return price * (1 - applicable_discount)
    
    def apply_promotions(self, price, product, customer, context):
        """Apply active promotions"""
        now = timezone.now()
        
        # Get active promotions
        promotions = Promotion.objects.filter(
            company=self.company,
            is_active=True,
            start_date__lte=now,
            end_date__gte=now
        ).filter(
            Q(products=product) | Q(categories=product.category) | Q(all_products=True)
        )
        
        # Apply best non-stackable promotion
        best_price = price
        for promo in promotions:
            if not promo.stackable:
                promo_price = promo.calculate_discounted_price(price)
                if promo_price < best_price:
                    best_price = promo_price
                    self.record_applied_discount(promo)
        
        # Apply all stackable promotions
        for promo in promotions.filter(stackable=True):
            best_price = promo.calculate_discounted_price(best_price)
            self.record_applied_discount(promo)
        
        return best_price
    
    def calculate_gst(self, amount, gst_type):
        """Calculate GST based on product classification"""
        gst_rates = {
            'standard_rated': Decimal('0.09'),  # 9%
            'zero_rated': Decimal('0.00'),
            'exempt': None,  # No GST applicable
            'out_of_scope': None
        }
        
        rate = gst_rates.get(gst_type, Decimal('0.09'))
        
        if rate is None:
            return None
        
        return amount * rate

# Pricing rules configuration
pricing_rules_config = {
    'customer_tiers': {
        'retail': {
            'multiplier': 1.00,
            'minimum_order': 0,
            'payment_terms': 'Immediate',
            'credit_limit': 0
        },
        'wholesale': {
            'multiplier': 0.70,
            'minimum_order': 1000,  # SGD
            'payment_terms': 'Net 30',
            'credit_limit': 10000
        },
        'vip': {
            'multiplier': 0.80,
            'minimum_order': 0,
            'payment_terms': 'Net 14',
            'credit_limit': 5000
        },
        'distributor': {
            'multiplier': 0.60,
            'minimum_order': 5000,
            'payment_terms': 'Net 45',
            'credit_limit': 50000
        }
    },
    
    'promotion_types': {
        'percentage_discount': {
            'description': 'X% off regular price',
            'stackable': False,
            'examples': ['10% off all shirts', '20% off clearance']
        },
        'fixed_discount': {
            'description': 'S$X off regular price',
            'stackable': False,
            'examples': ['S$10 off orders over S$100']
        },
        'buy_x_get_y': {
            'description': 'Buy X items, get Y free',
            'stackable': False,
            'examples': ['Buy 2 get 1 free', 'Buy 3 pay for 2']
        },
        'bundle_pricing': {
            'description': 'Fixed price for product set',
            'stackable': False,
            'examples': ['Phone + Case + Protector = S$999']
        },
        'free_shipping': {
            'description': 'Free shipping over threshold',
            'stackable': True,
            'examples': ['Free shipping on orders over S$80']
        },
        'loyalty_points': {
            'description': 'Extra points multiplier',
            'stackable': True,
            'examples': ['2X points on weekends']
        }
    },
    
    'gst_types': {
        'standard_rated': {
            'rate': 0.09,
            'description': 'Standard GST at 9%',
            'f5_box': 'Box 1 (Standard-rated supplies)'
        },
        'zero_rated': {
            'rate': 0.00,
            'description': 'Zero-rated (exports, prescribed supplies)',
            'f5_box': 'Box 2 (Zero-rated supplies)'
        },
        'exempt': {
            'rate': None,
            'description': 'Exempt supplies (financial services)',
            'f5_box': 'Box 3 (Exempt supplies)'
        },
        'out_of_scope': {
            'rate': None,
            'description': 'Outside scope of GST',
            'f5_box': 'Not reported'
        }
    }
}
5. FUNCTIONAL REQUIREMENTS - E-COMMERCE & INVENTORY
5.1 E-Commerce Module
5.1.1 Product Catalog Management
Product Data Model:

Python

from django.db import models
from django.contrib.postgres.fields import ArrayField
from decimal import Decimal

class Product(models.Model):
    """Core product model with comprehensive e-commerce and compliance fields"""
    
    GST_TYPES = [
        ('standard_rated', 'Standard Rated (9%)'),
        ('zero_rated', 'Zero Rated (0%)'),
        ('exempt', 'Exempt'),
        ('out_of_scope', 'Out of Scope'),
    ]
    
    STATUS_CHOICES = [
        ('draft', 'Draft'),
        ('active', 'Active'),
        ('inactive', 'Inactive'),
        ('discontinued', 'Discontinued'),
    ]
    
    # Relationships
    company = models.ForeignKey('Company', on_delete=models.CASCADE, related_name='products')
    category = models.ForeignKey('Category', on_delete=models.PROTECT, related_name='products')
    brand = models.ForeignKey('Brand', on_delete=models.SET_NULL, null=True, blank=True)
    supplier = models.ForeignKey('Supplier', on_delete=models.SET_NULL, null=True, blank=True)
    
    # Identification
    sku = models.CharField(max_length=50, 
Something went w
