# Generated by Django 6.0 on 2025-12-19 14:55

import apps.commerce.models.cart
import django.db.models.deletion
import django.utils.timezone
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = False  # No longer initial, depends on schema creation

    dependencies = [
        ('commerce', '0001_create_schema'),  # Depends on schema creation
        ('accounts', '0002_alter_company_options_alter_role_options_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Category',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier (UUID4)', primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='When this record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='When this record was last updated')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, help_text='When this record was soft-deleted', null=True)),
                ('name', models.CharField(help_text='Category display name', max_length=100)),
                ('slug', models.SlugField(help_text='URL-friendly identifier', max_length=100)),
                ('description', models.TextField(blank=True, help_text='Optional detailed description')),
                ('image_url', models.URLField(blank=True, help_text='Optional category image URL', max_length=500)),
                ('meta_title', models.CharField(blank=True, help_text='SEO title (max 70 chars)', max_length=70)),
                ('meta_description', models.CharField(blank=True, help_text='SEO meta description (max 160 chars)', max_length=160)),
                ('sort_order', models.IntegerField(default=0, help_text='Display order within parent category')),
                ('is_active', models.BooleanField(default=True, help_text='Whether category is visible to customers')),
                ('company', models.ForeignKey(help_text='Company that owns this category', on_delete=django.db.models.deletion.CASCADE, related_name='categories', to='accounts.company')),
                ('parent', models.ForeignKey(blank=True, help_text='Parent category (null for top-level)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='children', to='commerce.category')),
            ],
            options={
                'verbose_name': 'Category',
                'verbose_name_plural': 'Categories',
                'db_table': '"commerce"."categories"',
                'ordering': ['sort_order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='Customer',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier (UUID4)', primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='When this record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='When this record was last updated')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, help_text='When this record was soft-deleted', null=True)),
                ('email', models.EmailField(help_text='Customer email address', max_length=255)),
                ('phone', models.CharField(blank=True, help_text='Contact phone number', max_length=20)),
                ('first_name', models.CharField(help_text='Customer first name', max_length=100)),
                ('last_name', models.CharField(help_text='Customer last name', max_length=100)),
                ('customer_type', models.CharField(choices=[('retail', 'Retail'), ('wholesale', 'Wholesale'), ('vip', 'VIP')], default='retail', help_text='Customer classification', max_length=20)),
                ('company_name', models.CharField(blank=True, help_text='B2B customer company name', max_length=200)),
                ('company_uen', models.CharField(blank=True, help_text='Singapore UEN for B2B customers', max_length=10)),
                ('credit_limit', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Credit limit for B2B customers', max_digits=12)),
                ('credit_used', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Current credit usage', max_digits=12)),
                ('payment_terms', models.PositiveIntegerField(default=0, help_text='Payment terms in days (0 = immediate)')),
                ('consent_marketing', models.BooleanField(default=False, help_text='PDPA: Explicit opt-in for marketing communications')),
                ('consent_analytics', models.BooleanField(default=True, help_text='PDPA: Opt-out consent for analytics')),
                ('consent_timestamp', models.DateTimeField(blank=True, help_text='When consent was recorded', null=True)),
                ('consent_ip_address', models.GenericIPAddressField(blank=True, help_text='IP address when consent was given', null=True)),
                ('data_retention_until', models.DateField(blank=True, help_text='PDPA: Auto-purge date for customer data', null=True)),
                ('preferred_language', models.CharField(default='en', help_text='Preferred communication language', max_length=5)),
                ('preferred_currency', models.CharField(default='SGD', help_text='Preferred currency', max_length=3)),
                ('tags', models.JSONField(blank=True, default=list, help_text='Customer tags for segmentation')),
                ('company', models.ForeignKey(help_text='Company that owns this customer record', on_delete=django.db.models.deletion.CASCADE, related_name='customers', to='accounts.company')),
                ('user', models.ForeignKey(blank=True, help_text='Optional linked user account', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='customer_profiles', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Customer',
                'verbose_name_plural': 'Customers',
                'db_table': '"commerce"."customers"',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Cart',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier (UUID4)', primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='When this record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='When this record was last updated')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, help_text='When this record was soft-deleted', null=True)),
                ('session_id', models.CharField(blank=True, help_text='Session ID for guest carts', max_length=100, null=True)),
                ('status', models.CharField(choices=[('active', 'Active'), ('merged', 'Merged'), ('converted', 'Converted'), ('abandoned', 'Abandoned')], default='active', help_text='Cart status', max_length=20)),
                ('expires_at', models.DateTimeField(default=apps.commerce.models.cart.default_cart_expiry, help_text='When this cart expires')),
                ('converted_order_id', models.UUIDField(blank=True, help_text='Order ID if cart was converted', null=True)),
                ('converted_at', models.DateTimeField(blank=True, help_text='When cart was converted to order', null=True)),
                ('company', models.ForeignKey(help_text='Company this cart belongs to', on_delete=django.db.models.deletion.CASCADE, related_name='carts', to='accounts.company')),
                ('customer', models.ForeignKey(blank=True, help_text='Customer who owns this cart', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='carts', to='commerce.customer')),
            ],
            options={
                'verbose_name': 'Cart',
                'verbose_name_plural': 'Carts',
                'db_table': '"commerce"."carts"',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CustomerAddress',
            fields=[
                ('id', models.UUIDField(default=None, editable=False, primary_key=True, serialize=False)),
                ('address_type', models.CharField(choices=[('shipping', 'Shipping'), ('billing', 'Billing')], default='shipping', help_text='Address type', max_length=20)),
                ('is_default', models.BooleanField(default=False, help_text='Whether this is the default address for its type')),
                ('recipient_name', models.CharField(help_text='Recipient name', max_length=200)),
                ('phone', models.CharField(blank=True, help_text='Contact phone for delivery', max_length=20)),
                ('address_line1', models.CharField(help_text='Street address', max_length=255)),
                ('address_line2', models.CharField(blank=True, help_text='Additional address info', max_length=255)),
                ('postal_code', models.CharField(help_text='Singapore 6-digit postal code', max_length=6)),
                ('country', models.CharField(default='SG', help_text='Country code (ISO 3166-1 alpha-2)', max_length=2)),
                ('building_name', models.CharField(blank=True, help_text='Building or condo name', max_length=200)),
                ('unit_number', models.CharField(blank=True, help_text='Unit number (e.g., #01-01)', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('customer', models.ForeignKey(help_text='Customer this address belongs to', on_delete=django.db.models.deletion.CASCADE, related_name='addresses', to='commerce.customer')),
            ],
            options={
                'verbose_name': 'Customer Address',
                'verbose_name_plural': 'Customer Addresses',
                'db_table': '"commerce"."customer_addresses"',
                'ordering': ['-is_default', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Order',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier (UUID4)', primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='When this record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='When this record was last updated')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, help_text='When this record was soft-deleted', null=True)),
                ('order_number', models.CharField(help_text='Unique order number', max_length=50)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('confirmed', 'Confirmed'), ('processing', 'Processing'), ('shipped', 'Shipped'), ('delivered', 'Delivered'), ('cancelled', 'Cancelled'), ('refunded', 'Refunded')], default='pending', help_text='Order lifecycle status', max_length=30)),
                ('payment_status', models.CharField(choices=[('pending', 'Pending'), ('authorized', 'Authorized'), ('paid', 'Paid'), ('partially_refunded', 'Partially Refunded'), ('refunded', 'Refunded'), ('failed', 'Failed')], default='pending', help_text='Payment processing status', max_length=30)),
                ('fulfillment_status', models.CharField(choices=[('unfulfilled', 'Unfulfilled'), ('partially_fulfilled', 'Partially Fulfilled'), ('fulfilled', 'Fulfilled'), ('returned', 'Returned')], default='unfulfilled', help_text='Fulfillment/shipping status', max_length=30)),
                ('subtotal', models.DecimalField(decimal_places=2, help_text='Order subtotal before discounts and shipping', max_digits=12)),
                ('discount_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Total discount amount', max_digits=12)),
                ('shipping_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Shipping cost', max_digits=12)),
                ('gst_amount', models.DecimalField(decimal_places=2, help_text='Total GST amount', max_digits=12)),
                ('total_amount', models.DecimalField(decimal_places=2, help_text='Final order total including GST', max_digits=12)),
                ('gst_box_1_amount', models.DecimalField(blank=True, decimal_places=2, help_text='Box 1: Standard-rated supplies', max_digits=12, null=True)),
                ('gst_box_6_amount', models.DecimalField(blank=True, decimal_places=2, help_text='Box 6: Output tax due', max_digits=12, null=True)),
                ('currency', models.CharField(default='SGD', help_text='Order currency', max_length=3)),
                ('payment_method', models.CharField(blank=True, help_text='Payment method used', max_length=50)),
                ('payment_reference', models.CharField(blank=True, help_text='Payment gateway reference', max_length=100)),
                ('shipping_method', models.CharField(blank=True, help_text='Shipping method/carrier', max_length=50)),
                ('shipping_address', models.JSONField(blank=True, help_text='Shipping address snapshot', null=True)),
                ('billing_address', models.JSONField(blank=True, help_text='Billing address snapshot', null=True)),
                ('tracking_number', models.CharField(blank=True, help_text='Shipment tracking number', max_length=100)),
                ('carrier', models.CharField(blank=True, help_text='Shipping carrier name', max_length=50)),
                ('order_date', models.DateTimeField(default=django.utils.timezone.now, help_text='When order was placed')),
                ('paid_at', models.DateTimeField(blank=True, help_text='When payment was received', null=True)),
                ('shipped_at', models.DateTimeField(blank=True, help_text='When order was shipped', null=True)),
                ('delivered_at', models.DateTimeField(blank=True, help_text='When order was delivered', null=True)),
                ('cancelled_at', models.DateTimeField(blank=True, help_text='When order was cancelled', null=True)),
                ('customer_notes', models.TextField(blank=True, help_text='Notes from customer')),
                ('internal_notes', models.TextField(blank=True, help_text='Internal staff notes')),
                ('metadata', models.JSONField(blank=True, default=dict, help_text='Additional order metadata')),
                ('company', models.ForeignKey(help_text='Company that owns this order', on_delete=django.db.models.deletion.CASCADE, related_name='orders', to='accounts.company')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this order', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_orders', to=settings.AUTH_USER_MODEL)),
                ('customer', models.ForeignKey(blank=True, help_text='Customer who placed this order', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='orders', to='commerce.customer')),
            ],
            options={
                'verbose_name': 'Order',
                'verbose_name_plural': 'Orders',
                'db_table': '"commerce"."orders"',
                'ordering': ['-order_date'],
            },
        ),
        migrations.CreateModel(
            name='Product',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, help_text='Unique identifier (UUID4)', primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='When this record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='When this record was last updated')),
                ('deleted_at', models.DateTimeField(blank=True, db_index=True, help_text='When this record was soft-deleted', null=True)),
                ('sku', models.CharField(help_text='Stock Keeping Unit (unique per company)', max_length=50)),
                ('barcode', models.CharField(blank=True, help_text='Product barcode (EAN, UPC, etc.)', max_length=50)),
                ('name', models.CharField(help_text='Product display name', max_length=200)),
                ('slug', models.SlugField(help_text='URL-friendly identifier', max_length=200)),
                ('description', models.TextField(blank=True, help_text='Full product description')),
                ('short_description', models.CharField(blank=True, help_text='Brief product summary', max_length=500)),
                ('base_price', models.DecimalField(decimal_places=2, help_text='Base selling price in SGD', max_digits=10)),
                ('cost_price', models.DecimalField(blank=True, decimal_places=2, help_text='Cost price for margin calculation', max_digits=10, null=True)),
                ('compare_at_price', models.DecimalField(blank=True, decimal_places=2, help_text='Original price for showing discounts', max_digits=10, null=True)),
                ('gst_code', models.CharField(choices=[('SR', 'Standard Rated'), ('ZR', 'Zero Rated'), ('ES', 'Exempt Supply'), ('OS', 'Out of Scope')], default='SR', help_text='Singapore GST classification code', max_length=2)),
                ('gst_rate', models.DecimalField(decimal_places=4, default=Decimal('0.09'), help_text='GST rate (default 9% for SR)', max_digits=5)),
                ('weight_grams', models.PositiveIntegerField(blank=True, help_text='Product weight in grams', null=True)),
                ('length_cm', models.DecimalField(blank=True, decimal_places=2, help_text='Length in centimeters', max_digits=6, null=True)),
                ('width_cm', models.DecimalField(blank=True, decimal_places=2, help_text='Width in centimeters', max_digits=6, null=True)),
                ('height_cm', models.DecimalField(blank=True, decimal_places=2, help_text='Height in centimeters', max_digits=6, null=True)),
                ('track_inventory', models.BooleanField(default=True, help_text='Whether to track stock levels')),
                ('allow_backorder', models.BooleanField(default=False, help_text='Allow orders when out of stock')),
                ('low_stock_threshold', models.PositiveIntegerField(default=10, help_text='Alert threshold for low stock')),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('active', 'Active'), ('archived', 'Archived')], default='draft', help_text='Product visibility status', max_length=20)),
                ('images', models.JSONField(blank=True, default=list, help_text='List of product image URLs')),
                ('meta_title', models.CharField(blank=True, help_text='SEO title', max_length=70)),
                ('meta_description', models.CharField(blank=True, help_text='SEO meta description', max_length=160)),
                ('attributes', models.JSONField(blank=True, default=dict, help_text='Custom product attributes as key-value pairs')),
                ('category', models.ForeignKey(blank=True, help_text='Product category', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='products', to='commerce.category')),
                ('company', models.ForeignKey(help_text='Company that owns this product', on_delete=django.db.models.deletion.CASCADE, related_name='products', to='accounts.company')),
            ],
            options={
                'verbose_name': 'Product',
                'verbose_name_plural': 'Products',
                'db_table': '"commerce"."products"',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ProductVariant',
            fields=[
                ('id', models.UUIDField(default=None, editable=False, primary_key=True, serialize=False)),
                ('sku', models.CharField(help_text='Variant SKU (globally unique)', max_length=50, unique=True)),
                ('barcode', models.CharField(blank=True, help_text='Variant barcode', max_length=50)),
                ('name', models.CharField(blank=True, help_text='Optional variant name', max_length=200)),
                ('options', models.JSONField(blank=True, default=dict, help_text="Variant options (e.g., {'size': 'M', 'color': 'Blue'})")),
                ('price_adjustment', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Price adjustment from base price (can be negative)', max_digits=10)),
                ('weight_grams', models.PositiveIntegerField(blank=True, help_text='Override weight for this variant', null=True)),
                ('is_active', models.BooleanField(default=True, help_text='Whether variant is available')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('product', models.ForeignKey(help_text='Parent product', on_delete=django.db.models.deletion.CASCADE, related_name='variants', to='commerce.product')),
            ],
            options={
                'verbose_name': 'Product Variant',
                'verbose_name_plural': 'Product Variants',
                'db_table': '"commerce"."product_variants"',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='OrderItem',
            fields=[
                ('id', models.UUIDField(default=None, editable=False, primary_key=True, serialize=False)),
                ('order_date', models.DateTimeField(help_text='Order date (for partition alignment)')),
                ('sku', models.CharField(help_text='Product SKU at time of order', max_length=50)),
                ('name', models.CharField(help_text='Product name at time of order', max_length=200)),
                ('quantity', models.PositiveIntegerField(help_text='Quantity ordered')),
                ('unit_price', models.DecimalField(decimal_places=2, help_text='Unit price at time of order', max_digits=10)),
                ('discount_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Discount on this line item', max_digits=10)),
                ('gst_rate', models.DecimalField(decimal_places=4, help_text='GST rate applied', max_digits=5)),
                ('gst_amount', models.DecimalField(decimal_places=2, help_text='GST amount for this line', max_digits=10)),
                ('gst_code', models.CharField(help_text='GST code applied', max_length=2)),
                ('line_total', models.DecimalField(decimal_places=2, help_text='Total for this line item including GST', max_digits=10)),
                ('fulfilled_quantity', models.PositiveIntegerField(default=0, help_text='Quantity fulfilled/shipped')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('order', models.ForeignKey(help_text='Order this item belongs to', on_delete=django.db.models.deletion.CASCADE, related_name='items', to='commerce.order')),
                ('product', models.ForeignKey(help_text='Product ordered', on_delete=django.db.models.deletion.PROTECT, related_name='order_items', to='commerce.product')),
                ('variant', models.ForeignKey(blank=True, help_text='Product variant if applicable', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='order_items', to='commerce.productvariant')),
            ],
            options={
                'verbose_name': 'Order Item',
                'verbose_name_plural': 'Order Items',
                'db_table': '"commerce"."order_items"',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='CartItem',
            fields=[
                ('id', models.UUIDField(default=None, editable=False, primary_key=True, serialize=False)),
                ('quantity', models.PositiveIntegerField(default=1, help_text='Quantity of this item')),
                ('unit_price', models.DecimalField(decimal_places=2, help_text='Price per unit at time of adding to cart', max_digits=10)),
                ('is_saved_for_later', models.BooleanField(default=False, help_text='Item saved for later, not in active cart')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('cart', models.ForeignKey(help_text='Cart this item belongs to', on_delete=django.db.models.deletion.CASCADE, related_name='items', to='commerce.cart')),
                ('product', models.ForeignKey(help_text='Product being purchased', on_delete=django.db.models.deletion.PROTECT, related_name='cart_items', to='commerce.product')),
                ('variant', models.ForeignKey(blank=True, help_text='Optional product variant', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='cart_items', to='commerce.productvariant')),
            ],
            options={
                'verbose_name': 'Cart Item',
                'verbose_name_plural': 'Cart Items',
                'db_table': '"commerce"."cart_items"',
                'ordering': ['created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='category',
            index=models.Index(fields=['company'], name='categories_company_5233a9_idx'),
        ),
        migrations.AddIndex(
            model_name='category',
            index=models.Index(fields=['parent'], name='categories_parent__7983b2_idx'),
        ),
        migrations.AddIndex(
            model_name='category',
            index=models.Index(fields=['is_active'], name='categories_is_acti_aae090_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='category',
            unique_together={('company', 'slug')},
        ),
        migrations.AddIndex(
            model_name='customer',
            index=models.Index(fields=['company'], name='customers_company_df4bb6_idx'),
        ),
        migrations.AddIndex(
            model_name='customer',
            index=models.Index(fields=['email'], name='customers_email_92e882_idx'),
        ),
        migrations.AddIndex(
            model_name='customer',
            index=models.Index(fields=['company', 'customer_type'], name='customers_company_660b65_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='customer',
            unique_together={('company', 'email')},
        ),
        migrations.AddIndex(
            model_name='cart',
            index=models.Index(fields=['company'], name='carts_company_cd599f_idx'),
        ),
        migrations.AddIndex(
            model_name='cart',
            index=models.Index(fields=['customer'], name='carts_custome_91bdb8_idx'),
        ),
        migrations.AddIndex(
            model_name='cart',
            index=models.Index(fields=['session_id'], name='carts_session_d83355_idx'),
        ),
        migrations.AddIndex(
            model_name='cart',
            index=models.Index(fields=['expires_at'], name='carts_expires_8643c1_idx'),
        ),
        migrations.AddConstraint(
            model_name='cart',
            constraint=models.CheckConstraint(condition=models.Q(('customer__isnull', False), ('session_id__isnull', False), _connector='OR'), name='cart_identifier_required'),
        ),
        migrations.AddIndex(
            model_name='customeraddress',
            index=models.Index(fields=['customer'], name='customer_ad_custome_d72c9a_idx'),
        ),
        migrations.AddIndex(
            model_name='order',
            index=models.Index(fields=['company', 'status'], name='orders_company_e70153_idx'),
        ),
        migrations.AddIndex(
            model_name='order',
            index=models.Index(fields=['customer'], name='orders_custome_6c3a7f_idx'),
        ),
        migrations.AddIndex(
            model_name='order',
            index=models.Index(fields=['order_number'], name='orders_order_n_1336be_idx'),
        ),
        migrations.AddIndex(
            model_name='order',
            index=models.Index(fields=['order_date'], name='orders_order_d_6e39a9_idx'),
        ),
        migrations.AddIndex(
            model_name='product',
            index=models.Index(fields=['company'], name='products_company_7fb65d_idx'),
        ),
        migrations.AddIndex(
            model_name='product',
            index=models.Index(fields=['category'], name='products_categor_4083ff_idx'),
        ),
        migrations.AddIndex(
            model_name='product',
            index=models.Index(fields=['company', 'status'], name='products_company_43df46_idx'),
        ),
        migrations.AddIndex(
            model_name='product',
            index=models.Index(fields=['sku'], name='products_sku_fe2039_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='product',
            unique_together={('company', 'sku')},
        ),
        migrations.AddIndex(
            model_name='productvariant',
            index=models.Index(fields=['product'], name='product_var_product_017fde_idx'),
        ),
        migrations.AddIndex(
            model_name='orderitem',
            index=models.Index(fields=['order'], name='order_items_order_i_26ad88_idx'),
        ),
        migrations.AddIndex(
            model_name='orderitem',
            index=models.Index(fields=['product'], name='order_items_product_a53db1_idx'),
        ),
        migrations.AddConstraint(
            model_name='orderitem',
            constraint=models.CheckConstraint(condition=models.Q(('quantity__gt', 0)), name='order_item_quantity_positive'),
        ),
        migrations.AddIndex(
            model_name='cartitem',
            index=models.Index(fields=['cart'], name='cart_items_cart_id_3caa7d_idx'),
        ),
        migrations.AddConstraint(
            model_name='cartitem',
            constraint=models.CheckConstraint(condition=models.Q(('quantity__gt', 0)), name='cart_item_quantity_positive'),
        ),
        migrations.AlterUniqueTogether(
            name='cartitem',
            unique_together={('cart', 'product', 'variant')},
        ),
    ]
